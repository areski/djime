{% extends "site_base.html" %}

{% load i18n %}

{% block content %}
  <div id="block-list" class="block">
    <div class="content">
      <h2 class="title">{% trans "Current tasks" %}</h2>
      <div class="inner">
        <ul class="item-list slip-list list">
          {% for slip in slip_list %}
            <li class="slip slip-{{ slip.id }}">
              <div class="left">*</div>
              <div class="right">
                <a href="{% url slip_page slip_id=slip.id %}">
                  <span class="elapsed-time">{{ slip.display_time }}</span>
                  {{slip.name}}
                </a>
              </div>
            </li>
          {% endfor %}
        </ul>
      </div>
      <h2 class="title">{% trans "Current projects" %}</h2>
      <div class="inner">
        <ul class="item-list project-list list">
          {% for project in project_list %}
            <li class="project project-{{ project.id }}">
              <div class="left">*</div>
              <div class="right">
                <a href="{% url project_page project_id=project.id %}">
                  <span class="elapsed-time">{{ project.elapsed_time }}</span>
                    {{project.name}}
                </a>
              </div>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
{% endblock %}

{% block sidebar %}
    {% if slip_add_form %}
    <div class="block">
      <h3>{% trans "Create a new task" %}</h3>
      <form class="form" method="post" action="{% url slip_create %}">
        <ul class="form-items">
          <div class="group">
            {{ slip_add_form.name.errors }}
            <label for="id_name">Name:</label>
            {{ slip_add_form.name }}
          </div>
          <div class="group">
            {{ slip_add_form.project.errors }}
            <label for="id_project">Project:</label>
            {{ slip_add_form.project }}
          </div>
          <div class="group">
            {{ slip_add_form.client.errors }}
            <label for="id_client">Client:</label>
            {{ slip_add_form.client }}
          </div>
          <input type="submit" value="Add a new task" />
        </ul>
      </form>
    </div>
    {% endif %}
{% endblock %}

{% block closure %}
  <script type="text/javascript" src="{{ STATIC_URL }}js/djime.js"></script>
  <script type="text/javascript" src="{{ DEMO_STATIC_URL }}/js/jquery.autocomplete.js"></script>
  <script type="text/javascript">
  djime.autocomplete_projectnames = new Array()
  {% for project in project_js_list %}
    djime.autocomplete_projectnames[{{ forloop.counter0 }}] = new Array("{{ project }}", "{{ project.client.id }}");
  {% endfor %}
  </script>
  <script type="text/javascript">
  djime.client_list = {{ client_list|safe }}
  </script>
{% endblock %}

